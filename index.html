<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial‚Äëscale=1.0"/>
  <title>Boss AI Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap" rel="stylesheet"/>
  <style>
    * { box-sizing: border-box; margin:0; padding:0; }
    body {
      font-family:'Orbitron',sans-serif; background:linear-gradient(to right,#000,#0a0a2a);
      color:#00bfff; display:flex; height:100vh; overflow:hidden;
    }
    .sidebar {
      position:fixed; left:0; top:0; width:240px; height:100vh;
      background:#0d0d0d; padding:60px 10px 20px;
      display:flex; flex-direction:column; gap:10px;
      transition:transform .3s ease;
      border-right:2px solid #1a1a1a;
    }
    .sidebar.hidden { transform:translateX(-100%); }
    .sidebar button {
      background:#121212; color:#00bfff; border:none;
      padding:12px; font-size:14px; text-align:left;
      border-radius:6px; cursor:pointer; transition:background .3s;
    }
    .sidebar button:hover { background:#003366; color:#4fc3f7; }
    .sidebar button.active { background:#007bff; color:#fff; }
    #toggle-btn {
      position:fixed; top:15px; left:15px; z-index:1001;
      background:#007bff; color:#fff; padding:10px 16px;
      font-size:16px; border:none; border-radius:6px;
      cursor:pointer;
    }
    .main {
      margin-left:240px; padding:20px; flex:1;
      display:flex; flex-direction:column;
      overflow-y:auto; transition:margin .3s;
    }
    .main.full { margin-left:0; }
    textarea,input {
      width:100%; max-width:600px;
      padding:12px; margin-top:10px;
      border:1px solid #00bfff; border-radius:6px;
      background:#1a1a1a; color:#fff;
      font-size:15px;
    }
    button.generate-btn {
      background:#007bff; color:#fff; border:none;
      padding:10px 16px; margin-top:10px;
      border-radius:6px; font-family:'Orbitron',sans-serif;
      cursor:pointer;
    }
    .glow { text-shadow:0 0 5px #00bfff,0 0 10px #00bfff; }
    #manager-output {
      background:#121212; border:1px solid #00bfff;
      padding:10px; margin-top:10px; border-radius:6px;
      max-height:300px; overflow-y:auto;
      font-family:monospace;
    }
  </style>
</head>
<body>

<button id="toggle-btn">‚ò∞ Menu</button>

<div class="sidebar" id="sidebar">
  <button data-module="manager" class="active">ü§ñ Manager AI</button>
  <button data-module="script">‚úçÔ∏è Script Writer</button>
  <button data-module="voiceover">üé§ Voiceover</button>
  <button data-module="video">üé¨ Video Generator</button>
</div>

<div class="main" id="main">
  <h1 class="glow">Boss AI Dashboard</h1>
  <p class="glow">Welcome! Select a module or ask Manager AI to assist.</p>
</div>

<script>
  const toggleBtn = document.getElementById('toggle-btn');
  const sidebar = document.getElementById('sidebar');
  const main = document.getElementById('main');

  toggleBtn.addEventListener('click', () => {
    sidebar.classList.toggle('hidden');
    main.classList.toggle('full');
  });

  const modules = {
    manager: `
      <h2 class="glow">ü§ñ Manager AI</h2>
      <textarea id="manager-command" placeholder="Commands: hide sidebar, switch to script, git push"></textarea>
      <button class="generate-btn" onclick="runManager()">Send</button>
      <div id="manager-output"></div>
    `,
    script: `
      <h2 class="glow">‚úçÔ∏è Script Writer</h2>
      <textarea id="script-input" placeholder="Video idea..."></textarea>
      <div id="script-key-box"></div>
      <button class="generate-btn" onclick="generateScript()">Generate Script</button>
      <p id="script-output" class="glow"></p>
    `,
    voiceover: `
      <h2 class="glow">üé§ Voiceover</h2>
      <textarea id="voice-text" placeholder="Script text..."></textarea>
      <div id="voice-key-box"></div>
      <button class="generate-btn" onclick="generateVoice()">Generate Voice</button>
      <p id="voice-status" class="glow"></p>
    `,
    video: `
      <h2 class="glow">üé¨ Video Generator</h2>
      <p class="glow">Coming soon...</p>
    `
  };

  document.querySelectorAll('.sidebar button').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.sidebar button').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      const mod = btn.getAttribute('data-module');
      main.innerHTML = `<div>${modules[mod]}</div>`;
      if (mod === 'script') setupScriptKeyUI();
      if (mod === 'voiceover') setupVoiceKeyUI();
    });
  });

  function setupScriptKeyUI() {
    const box = document.getElementById('script-key-box');
    const key = localStorage.getItem('openrouter_key');
    box.innerHTML = key
      ? `<p class="glow">‚úÖ Key saved <button onclick="clearScriptKey()">Change</button></p>`
      : `<input id="script-key" type="password" placeholder="üîë OpenRouter Key"/>
         <button class="generate-btn" onclick="saveScriptKey()">Save</button>`;
  }
  function saveScriptKey() {
    const v = document.getElementById('script-key').value.trim();
    if (v.length > 10) { localStorage.setItem('openrouter_key', v); location.reload(); }
  }
  function clearScriptKey() { localStorage.removeItem('openrouter_key'); location.reload(); }

  async function generateScript() {
    const key = localStorage.getItem('openrouter_key');
    const input = document.getElementById('script-input').value.trim();
    const out = document.getElementById('script-output');
    if (!key || !input) return out.innerHTML = '‚ùå Missing input or key';
    out.innerHTML = 'üß† Generating...';
    try {
      const res = await fetch('https://openrouter.ai/api/v1/chat/completions', {
        method: 'POST', headers: { Authorization: 'Bearer '+key, 'Content-Type':'application/json' },
        body: JSON.stringify({
          model: 'openai/gpt-3.5-turbo',
          messages: [{role:'system',content:'Generate a short video script.'},{role:'user',content:input}]
        })
      });
      const data = await res.json();
      out.innerHTML = data.choices?.[0]?.message?.content || '‚ùå No response';
    } catch (e) { out.innerHTML = '‚ùå '+e.message; }
  }

  function setupVoiceKeyUI() {
    const box = document.getElementById('voice-key-box');
    const key = localStorage.getItem('elevenlabs_key');
    box.innerHTML = key
      ? `<p class="glow">‚úÖ Key saved <button onclick="clearVoiceKey()">Change</button></p>`
      : `<input id="voice-key" type="password" placeholder="üîë ElevenLabs Key"/>
         <button class="generate-btn" onclick="saveVoiceKey()">Save</button>`;
  }
  function saveVoiceKey() {
    const v = document.getElementById('voice-key').value.trim();
    if (v.length > 10) { localStorage.setItem('elevenlabs_key', v); location.reload(); }
  }
  function clearVoiceKey() { localStorage.removeItem('elevenlabs_key'); location.reload(); }

  async function generateVoice() {
    const key = localStorage.getItem('elevenlabs_key');
    const text = document.getElementById('voice-text').value.trim();
    const st = document.getElementById('voice-status');
    if (!key || !text) return st.innerHTML = '‚ùå Missing input or key';
    st.innerHTML = 'üß† Generating voice...';
    try {
      const res = await fetch('https://api.elevenlabs.io/v1/text-to-speech/pNInz6obpgDQGcFmaJgB', {
        method: 'POST', headers: { 'xi-api-key': key, 'Content-Type':'application/json' },
        body: JSON.stringify({ text })
      });
      const blob = await res.blob();
      const audio = new Audio(URL.createObjectURL(blob));
      audio.play();
      st.innerHTML = '‚úÖ Playing voice';
    } catch (e) { st.innerHTML = '‚ùå '+e.message; }
  }

  async function runManager() {
    const cmd = document.getElementById('manager-command').value.trim();
    const out = document.getElementById('manager-output');
    out.innerHTML = '';
    if (!cmd) return out.innerHTML = '‚ùå Enter a command';
    out.innerHTML = 'ü§ñ Thinking...';
    try {
      const res = await fetch('https://manager-ai-backend.onrender.com/command', {
        method: 'POST', headers: { 'Content-Type':'application/json' },
        body: JSON.stringify({ prompt: cmd })
      });
      const data = await res.json();
      out.innerHTML = data.response || '‚ùå No response';
      if (data.command) {
        try { eval(data.command); }
        catch (e) { out.innerHTML += '<br>JS Error: '+e.message; }
      }
    } catch (e) {
      out.innerHTML = '‚ùå Backend unreachable';
      console.error(e);
    }
  }

  // Always load manager on start
  window.onload = () => document.querySelector('[data-module="manager"]').click();
</script>

</body>
</html>
