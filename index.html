\<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Boss AI Dashboard</title>
  <style>
    body {
      margin: 0;
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
      color: #00c3ff;
      overflow-x: hidden;
    }

    h1, h2 {
      text-align: center;
      text-shadow: 0 0 10px #00c3ff;
    }

    .container {
      display: flex;
      flex-direction: row;
      height: 100vh;
    }

    .sidebar {
      width: 220px;
      background: rgba(0, 0, 0, 0.6);
      border-right: 2px solid #00c3ff;
      padding-top: 20px;
    }

    .sidebar button {
      width: 90%;
      margin: 10px;
      padding: 10px;
      background-color: transparent;
      border: 1px solid #00c3ff;
      color: #00c3ff;
      font-weight: bold;
      cursor: pointer;
    }

    .sidebar button:hover {
      background-color: #00c3ff;
      color: black;
    }

    .content {
      flex-grow: 1;
      padding: 20px;
      overflow-y: auto;
    }

    textarea, input[type="text"] {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      background-color: #111;
      color: #00c3ff;
      border: 1px solid #00c3ff;
    }

    .response-box {
      background-color: #000;
      border: 1px solid #00c3ff;
      padding: 10px;
      margin-top: 10px;
      max-height: 300px;
      overflow-y: scroll;
      white-space: pre-wrap;
    }

    .section {
      margin-bottom: 40px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="sidebar">
      <h2>Boss AI</h2>
      <button onclick="showModule('manager')">Manager AI</button>
      <button onclick="showModule('script')">Script Writer AI</button>
      <button onclick="showModule('voice')">Voiceover AI</button>
    </div>

    <div class="content">
      <div id="manager" class="section">
        <h2>Manager AI</h2>
        <textarea id="managerInput" placeholder="Ask Manager AI anything..."></textarea>
        <button onclick="askManager()">Submit</button>
        <div class="response-box" id="managerOutput"></div>
      </div>

      <div id="script" class="section" style="display:none;">
        <h2>Script Writer AI</h2>
        <input type="text" id="openrouterKey" placeholder="Enter OpenRouter API Key">
        <textarea id="scriptInput" placeholder="Describe the video script..."></textarea>
        <button onclick="generateScript()">Generate Script</button>
        <div class="response-box" id="scriptOutput"></div>
      </div>

      <div id="voice" class="section" style="display:none;">
        <h2>Voiceover AI</h2>
        <input type="text" id="elevenKey" placeholder="Enter ElevenLabs API Key">
        <textarea id="voiceText" placeholder="Paste script for voiceover..."></textarea>
        <button onclick="generateVoice()">Generate Voice</button>
        <audio id="audioPlayer" controls style="margin-top: 10px;"></audio>
      </div>
    </div>
  </div>

  <script>
    // Persistent key storage
    window.onload = () => {
      document.getElementById("openrouterKey").value = localStorage.getItem("openrouterKey") || "";
      document.getElementById("elevenKey").value = localStorage.getItem("elevenKey") || "";
    };

    function showModule(id) {
      ['manager', 'script', 'voice'].forEach(mod => {
        document.getElementById(mod).style.display = mod === id ? 'block' : 'none';
      });
    }

    async function askManager() {
      const input = document.getElementById("managerInput").value;
      const outputBox = document.getElementById("managerOutput");
      outputBox.innerHTML = "Processing...";
      const response = await fetch("https://manager-ai-backend-3.onrender.com/manager", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ prompt: input })
      });
      const data = await response.json();
      outputBox.innerHTML = data.reply || "No response.";

      if (data.command && data.command.startsWith("js:")) {
        try {
          eval(data.command.slice(3));
        } catch (e) {
          console.error("Execution error:", e);
        }
      }
    }

    async function generateScript() {
      const key = document.getElementById("openrouterKey").value;
      const prompt = document.getElementById("scriptInput").value;
      localStorage.setItem("openrouterKey", key);
      const outputBox = document.getElementById("scriptOutput");
      outputBox.innerHTML = "Generating script...";

      const res = await fetch("https://openrouter.ai/api/v1/chat/completions", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${key}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          model: "openai/gpt-3.5-turbo",
          messages: [{ role: "user", content: prompt }]
        })
      });
      const data = await res.json();
      outputBox.innerText = data.choices?.[0]?.message?.content || "No response.";
    }

    async function generateVoice() {
      const key = document.getElementById("elevenKey").value;
      const text = document.getElementById("voiceText").value;
      localStorage.setItem("elevenKey", key);

      const response = await fetch("https://api.elevenlabs.io/v1/text-to-speech/EXAVITQu4vr4xnSDxMaL", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "xi-api-key": key
        },
        body: JSON.stringify({
          text: text,
          model_id: "eleven_monolingual_v1",
          voice_settings: { stability: 0.5, similarity_boost: 0.5 }
        })
      });

      const blob = await response.blob();
      const audioUrl = URL.createObjectURL(blob);
      document.getElementById("audioPlayer").src = audioUrl;
    }
  </script>
</body>
</html>
