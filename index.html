<!-- PART 1: START OF FULL UPDATED CODE -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Boss AI Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet"/>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(to right, #000000, #0a0a2a);
      color: #00bfff;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }
    .glow { text-shadow: 0 0 5px #00bfff, 0 0 10px #00bfff; }
    .sidebar {
      width: 240px;
      background: #0d0d0d;
      padding: 60px 10px 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      height: 100vh;
      position: fixed;
      left: 0;
      top: 0;
      border-right: 2px solid #1a1a1a;
      z-index: 100;
      transition: transform 0.3s ease;
    }
    .sidebar.hidden { transform: translateX(-100%); }
    .sidebar button {
      background: #121212;
      color: #00bfff;
      border: none;
      padding: 12px;
      font-size: 14px;
      text-align: left;
      border-radius: 6px;
      cursor: pointer;
    }
    .sidebar button.active {
      background-color: #007bff;
      color: white;
    }
    .main {
      flex-grow: 1;
      margin-left: 240px;
      width: calc(100% - 240px);
      display: flex;
      justify-content: flex-start;
      align-items: flex-start;
      flex-direction: column;
      padding: 20px;
      overflow-y: auto;
    }
    .main.full {
      margin-left: 0;
      width: 100%;
    }
    #toggle-btn {
      position: fixed;
      top: 10px;
      left: 10px;
      z-index: 1000;
      background-color: #007bff;
      color: white;
      padding: 10px 16px;
      border-radius: 6px;
      font-size: 16px;
      border: none;
      cursor: pointer;
    }
    textarea, input {
      width: 100%;
      max-width: 500px;
      padding: 12px;
      margin-top: 10px;
      font-size: 15px;
      border-radius: 6px;
      border: 1px solid #00bfff;
      background-color: #1a1a1a;
      color: white;
    }
    button.generate-btn {
      background-color: #007bff;
      color: white;
      border: none;
      margin-top: 10px;
      padding: 10px 16px;
      border-radius: 6px;
      font-size: 15px;
      cursor: pointer;
    }
    .glow-box {
      max-width: 800px;
      padding: 10px;
      background: #121212;
      border: 1px solid #00bfff;
      margin-top: 10px;
      white-space: pre-wrap;
    }
    #automation-canvas {
      position: relative;
      border: 2px solid #00bfff;
      background: #1a1a1a;
      width: 100%;
      height: 500px;
      margin-top: 20px;
      overflow: hidden;
    }
    .node {
      position: absolute;
      background: #121212;
      border: 1px solid #00bfff;
      padding: 6px 10px;
      color: #00bfff;
      border-radius: 6px;
      cursor: move;
      user-select: none;
    }
    svg.connector {
      position: absolute;
      top: 0;
      left: 0;
      pointer-events: none;
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <button id="toggle-btn">‚ò∞ Menu</button>
  <div class="sidebar" id="sidebar">
    <button data-module="manager" class="active">ü§ñ Manager AI</button>
    <button data-module="script">‚úçÔ∏è Script Writer</button>
    <button data-module="voiceover">üé§ Voiceover</button>
    <button data-module="automation">‚öôÔ∏è Automation AI</button>
    <button data-module="upload">üì§ Upload Strategy</button>
    <button data-module="trends">üìà Trends</button>
    <button data-module="legal">üìë Legal Review</button>
    <button data-module="output">üì¶ Final Output</button>
    <button data-module="history">üóÇÔ∏è History</button>
    <button data-module="settings">‚öôÔ∏è Settings</button>
  </div>
  <div class="main" id="main">
    <h1 class="glow">Boss AI Dashboard</h1>
    <p class="glow">Welcome. Select a module or command Manager AI.</p>
  </div>

<script>
const toggleBtn = document.getElementById("toggle-btn"),
      sidebar = document.getElementById("sidebar"),
      main = document.getElementById("main");

const moduleDescriptions = {
  "Manager AI": "Controls the app interface and interconnects modules via natural language.",
  "Script Writer": "Generates video scripts from topics using GPT.",
  "Voiceover": "Turns text into voice using ElevenLabs API.",
  "Automation AI": "Connects modules like a flowchart; wires nodes visually.",
  "Upload Strategy": "Suggests platforms, times, and hashtags for uploading content.",
  "Trends": "Gathers trending content ideas based on topic or niche.",
  "Legal Review": "Reviews content for copyright and legal issues.",
  "Final Output": "Displays final assets like script and voiceover output.",
  "History": "Shows saved or previous sessions.",
  "Settings": "Manages app keys and storage."
};
</script>
<!-- PART 2: CONTINUED CODE -->

<script>
const content = {
  manager: `
    <h2 class="glow">ü§ñ Manager AI</h2>
    <textarea id="manager-command" placeholder="e.g., Connect Script Writer to Voiceover"></textarea>
    <button class="generate-btn" onclick="runManagerCommand()">Send</button>
    <div class="glow-box" id="manager-response"></div>
  `,
  script: `
    <h2 class="glow">‚úçÔ∏è Script Writer</h2>
    <textarea id="script-input" placeholder="Enter your video topic..."></textarea>
    <div id="script-key-box"></div>
    <button class="generate-btn" onclick="generateScript()">Generate Script</button>
    <div class="glow-box" id="script-output"></div>
  `,
  voiceover: `
    <h2 class="glow">üé§ Voiceover</h2>
    <textarea id="voice-text" placeholder="Enter your script here..."></textarea>
    <div id="voice-key-box"></div>
    <button class="generate-btn" onclick="generateVoice()">Generate Voice</button>
    <p class="glow" id="voice-status"></p>
  `,
  automation: `
    <h2 class="glow">‚öôÔ∏è Automation AI</h2>
    <button class="generate-btn" onclick="addNode('Script Writer')">+ Script Node</button>
    <button class="generate-btn" onclick="addNode('Voiceover')">+ Voice Node</button>
    <button class="generate-btn" onclick="clearNodes()">Reset</button>
    <div id="automation-canvas"><svg class="connector"></svg></div>
  `,
  upload: `
    <h2 class="glow">üì§ Upload Strategy AI</h2>
    <textarea id="upload-input" placeholder="Describe your content..."></textarea>
    <button class="generate-btn" onclick="generateUploadStrategy()">Generate Strategy</button>
    <div class="glow-box" id="upload-output"></div>
  `,
  trends: `
    <h2 class="glow">üìà Trends</h2>
    <textarea id="trend-input" placeholder="Topic or niche (e.g. finance, comedy)..."></textarea>
    <button class="generate-btn" onclick="fetchTrends()">Get Trends</button>
    <div class="glow-box" id="trend-output"></div>
  `,
  legal: `
    <h2 class="glow">üìë Legal Review</h2>
    <textarea id="legal-input" placeholder="Paste script or content for review..."></textarea>
    <button class="generate-btn" onclick="runLegalReview()">Run Legal Review</button>
    <div class="glow-box" id="legal-output"></div>
  `,
  output: `
    <h2 class="glow">üì¶ Final Output</h2>
    <div class="glow-box">
      <strong>Last Script:</strong>
      <div id="final-script-output"></div><br>
      <strong>Last Audio:</strong>
      <audio id="final-audio" controls></audio>
    </div>
  `,
  history: `
    <h2 class="glow">üóÇÔ∏è History</h2>
    <p class="glow">Coming soon: View saved sessions and outputs.</p>
  `,
  settings: `
    <h2 class="glow">‚öôÔ∏è Settings</h2>
    <p class="glow">Manage keys and preferences.</p>
    <button class="generate-btn" onclick="clearAllKeys()">Clear All Saved Keys</button>
  `
};

document.querySelectorAll(".sidebar button").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".sidebar button").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    const mod = btn.getAttribute("data-module");
    main.innerHTML = `<div style="max-width:800px;width:100%;">${content[mod]}</div>`;
    if (mod === "script") loadScriptKey();
    if (mod === "voiceover") loadVoiceKey();
    if (mod === "automation") initAutomation();
    if (mod === "output") loadFinalOutput();
  });
});

function loadScriptKey() {
  const key = localStorage.getItem("openrouter_key");
  const box = document.getElementById("script-key-box");
  box.innerHTML = key
    ? `<p class="glow">‚úÖ Key saved. <button class="generate-btn" onclick="clearScriptKey()">Change</button></p>`
    : `<input id="script-key" type="password" placeholder="üîë OpenRouter API Key"/><button class="generate-btn" onclick="saveScriptKey()">Save</button>`;
}
function clearScriptKey() { localStorage.removeItem("openrouter_key"); location.reload(); }
function saveScriptKey() {
  const val = document.getElementById("script-key").value.trim();
  if (val.length > 10) {
    localStorage.setItem("openrouter_key", val);
    location.reload();
  }
}
function loadVoiceKey() {
  const key = localStorage.getItem("elevenlabs_key");
  const box = document.getElementById("voice-key-box");
  box.innerHTML = key
    ? `<p class="glow">‚úÖ Key saved.</p>`
    : `<input id="voice-key" type="password" placeholder="üîë ElevenLabs Key"/><button class="generate-btn" onclick="saveVoiceKey()">Save</button>`;
}
function saveVoiceKey() {
  const val = document.getElementById("voice-key").value.trim();
  if (val.length > 10) {
    localStorage.setItem("elevenlabs_key", val);
    location.reload();
  }
}
function clearAllKeys() {
  localStorage.clear();
  alert("All saved keys cleared.");
  location.reload();
}
<!-- PART 3: MANAGER AI LOGIC + MODULE FUNCTIONALITY -->
<script>
async function runManagerCommand() {
  const command = document.getElementById("manager-command").value.trim();
  const box = document.getElementById("manager-response");
  const key = localStorage.getItem("openrouter_key");
  if (!key || !command) return (box.innerHTML = "‚ùå Missing input or key");

  const context = [
    { role: "system", content: "You are Manager AI. Your job is to understand the app layout and execute JavaScript when needed. If a user says 'Connect A to B', you will run addNode(A); addNode(B); drawLinkBetweenNodes(A,B). Modules: Manager AI, Script Writer, Voiceover, Automation AI, Upload Strategy AI, Trends AI, Legal Review AI, Final Output, History, Settings. You have access to Automation AI canvas." },
    { role: "user", content: command }
  ];

  box.innerHTML = "ü§ñ Thinking...";
  try {
    const res = await fetch("https://openrouter.ai/api/v1/chat/completions", {
      method: "POST",
      headers: {
        "Authorization": "Bearer " + key,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ model: "openai/gpt-3.5-turbo", messages: context })
    });
    const data = await res.json();
    const reply = data?.choices?.[0]?.message?.content || "‚ùå No response";

    // Parse basic command
    const connectMatch = command.match(/Connect (.+) to (.+)/i);
    if (connectMatch) {
      const from = connectMatch[1].trim();
      const to = connectMatch[2].trim();
      addNode(from);
      addNode(to);
      drawLinkBetweenNodes(from, to);
      box.innerHTML = "‚úÖ Connected " + from + " ‚Üí " + to;
    } else {
      box.innerHTML = reply;
    }
  } catch (err) {
    box.innerHTML = "‚ùå Connection error";
  }
}

// AUTOMATION NODE SYSTEM
let canvas, nodes = [], nodeCount = 0;

function initAutomation() {
  canvas = document.getElementById("automation-canvas");
  canvas.innerHTML = '<svg class="connector"></svg>';
  nodes = [];
  nodeCount = 0;
}

function addNode(label) {
  if (!canvas) canvas = document.getElementById("automation-canvas");
  const node = document.createElement("div");
  node.className = "node";
  node.textContent = label;
  node.dataset.label = label;
  node.dataset.id = ++nodeCount;
  node.style.left = `${60 + nodeCount * 50}px`;
  node.style.top = `${40 + nodeCount * 30}px`;
  makeDraggable(node);
  canvas.appendChild(node);
  nodes.push(node);
}

function drawLinkBetweenNodes(fromLabel, toLabel) {
  const from = nodes.find(n => n.dataset.label === fromLabel);
  const to = nodes.find(n => n.dataset.label === toLabel);
  if (!from || !to || !canvas) return;
  const svg = canvas.querySelector("svg");
  const fromRect = from.getBoundingClientRect();
  const toRect = to.getBoundingClientRect();
  const canvasRect = canvas.getBoundingClientRect();
  const x1 = fromRect.left + fromRect.width / 2 - canvasRect.left;
  const y1 = fromRect.top + fromRect.height / 2 - canvasRect.top;
  const x2 = toRect.left + toRect.width / 2 - canvasRect.left;
  const y2 = toRect.top + toRect.height / 2 - canvasRect.top;
  const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
  line.setAttribute("x1", x1);
  line.setAttribute("y1", y1);
  line.setAttribute("x2", x2);
  line.setAttribute("y2", y2);
  line.setAttribute("stroke", "#00bfff");
  line.setAttribute("stroke-width", 2);
  svg.appendChild(line);
}

function makeDraggable(el) {
  let offsetX = 0, offsetY = 0;
  el.onmousedown = function(e) {
    offsetX = e.clientX - el.offsetLeft;
    offsetY = e.clientY - el.offsetTop;
    document.onmousemove = function(e) {
      el.style.left = (e.clientX - offsetX) + "px";
      el.style.top = (e.clientY - offsetY) + "px";
    };
    document.onmouseup = function() {
      document.onmousemove = null;
      document.onmouseup = null;
    };
  };
}

// SCRIPT WRITER FUNCTION
async function generateScript() {
  const input = document.getElementById("script-input").value.trim();
  const key = localStorage.getItem("openrouter_key");
  const out = document.getElementById("script-output");
  if (!input || !key) return (out.innerText = "‚ùå Missing input or key");
  out.innerText = "üìù Writing script...";
  try {
    const res = await fetch("https://openrouter.ai/api/v1/chat/completions", {
      method: "POST",
      headers: {
        "Authorization": "Bearer " + key,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        model: "openai/gpt-3.5-turbo",
        messages: [
          { role: "system", content: "You are a short-form YouTube script writer. Generate engaging scripts under 60 seconds." },
          { role: "user", content: input }
        ]
      })
    });
    const data = await res.json();
    const text = data?.choices?.[0]?.message?.content || "‚ùå No response";
    out.innerText = text;
    localStorage.setItem("last_script", text);
  } catch {
    out.innerText = "‚ùå Error generating script";
  }
}

// VOICEOVER FUNCTION
async function generateVoice() {
  const text = document.getElementById("voice-text").value.trim();
  const key = localStorage.getItem("elevenlabs_key");
  const status = document.getElementById("voice-status");
  if (!text || !key) return (status.innerText = "‚ùå Missing text or key");

  status.innerText = "üîä Generating audio...";
  try {
    const res = await fetch("https://api.elevenlabs.io/v1/text-to-speech/TxGEqnHWrfWFTfGW9XjX", {
      method: "POST",
      headers: {
        "xi-api-key": key,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        text: text,
        voice_settings: { stability: 0.5, similarity_boost: 0.75 }
      })
    });
    const blob = await res.blob();
    const url = URL.createObjectURL(blob);
    const audio = document.getElementById("final-audio");
    audio.src = url;
    status.innerText = "‚úÖ Voice generated";
  } catch {
    status.innerText = "‚ùå Error generating voice";
  }
}

// OTHER MODULES
function generateUploadStrategy() {
  const input = document.getElementById("upload-input").value.trim();
  const key = localStorage.getItem("openrouter_key");
  const out = document.getElementById("upload-output");
  if (!input || !key) return (out.innerText = "‚ùå Missing input or key");
  out.innerText = "üì§ Analyzing upload strategy...";
  fetch("https://openrouter.ai/api/v1/chat/completions", {
    method: "POST",
    headers: {
      "Authorization": "Bearer " + key,
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      model: "openai/gpt-3.5-turbo",
      messages: [
        { role: "system", content: "You're a YouTube upload strategist." },
        { role: "user", content: input }
      ]
    })
  })
  .then(res => res.json())
  .then(data => {
    out.innerText = data?.choices?.[0]?.message?.content || "‚ùå No response";
  }).catch(() => {
    out.innerText = "‚ùå Error generating strategy";
  });
}

function fetchTrends() {
  const input = document.getElementById("trend-input").value.trim();
  const key = localStorage.getItem("openrouter_key");
  const out = document.getElementById("trend-output");
  if (!input || !key) return (out.innerText = "‚ùå Missing input or key");
  out.innerText = "üìà Fetching trends...";
  fetch("https://openrouter.ai/api/v1/chat/completions", {
    method: "POST",
    headers: {
      "Authorization": "Bearer " + key,
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      model: "openai/gpt-3.5-turbo",
      messages: [
        { role: "system", content: "You are a social media trend expert." },
        { role: "user", content: input }
      ]
    })
  })
  .then(res => res.json())
  .then(data => {
    out.innerText = data?.choices?.[0]?.message?.content || "‚ùå No response";
  }).catch(() => {
    out.innerText = "‚ùå Error fetching trends";
  });
}

function runLegalReview() {
  const input = document.getElementById("legal-input").value.trim();
  const key = localStorage.getItem("openrouter_key");
  const out = document.getElementById("legal-output");
  if (!input || !key) return (out.innerText = "‚ùå Missing input or key");
  out.innerText = "üìë Reviewing legality...";
  fetch("https://openrouter.ai/api/v1/chat/completions", {
    method: "POST",
    headers: {
      "Authorization": "Bearer " + key,
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      model: "openai/gpt-3.5-turbo",
      messages: [
        { role: "system", content: "You're a legal compliance checker. Review the content and respond with any legal risks." },
        { role: "user", content: input }
      ]
    })
  })
  .then(res => res.json())
  .then(data => {
    out.innerText = data?.choices?.[0]?.message?.content || "‚ùå No response";
  }).catch(() => {
    out.innerText = "‚ùå Error during legal review";
  });
}

function loadFinalOutput() {
  const script = localStorage.getItem("last_script");
  if (script) document.getElementById("final-script-output").innerText = script;
}
</script>
</body>
</html>
