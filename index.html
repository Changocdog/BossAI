<script>
  const apiKeyInput = document.getElementById("api-key");
  const generateBtn = document.getElementById("generate-btn");
  const userPrompt = document.getElementById("user-prompt");
  const contentPanel = document.getElementById("content-panel");
  let currentModule = "manager"; // Default module

  // Sidebar Switching
  const sidebarButtons = document.querySelectorAll(".sidebar button");
  sidebarButtons.forEach(button => {
    button.addEventListener("click", () => {
      sidebarButtons.forEach(btn => btn.classList.remove("active"));
      button.classList.add("active");
      currentModule = button.dataset.module;
      displayModule(currentModule);
    });
  });

  function displayModule(module) {
    if (module === "manager") {
      contentPanel.innerHTML = `<h2>General Manager AI</h2><p>Ask the Manager to oversee content creation and task coordination.</p>`;
    } else if (module === "legal") {
      contentPanel.innerHTML = `<h2>Legal AI Review</h2><p>This module checks content for compliance and copyright safety.</p>`;
    } else if (module === "script") {
      contentPanel.innerHTML = `
        <h2>Script Writer AI</h2>
        <textarea id="script-input" rows="4" placeholder="Enter your video topic or idea..."></textarea>
        <button id="run-script">Generate Script</button>
        <pre id="script-output">Script will appear here.</pre>
      `;

      document.getElementById("run-script").addEventListener("click", async () => {
        const prompt = document.getElementById("script-input").value;
        const apiKey = apiKeyInput.value.trim();
        const output = document.getElementById("script-output");
        output.textContent = "⏳ Generating script...";

        try {
          const response = await fetch("https://api.openai.com/v1/chat/completions", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              "Authorization": `Bearer ${apiKey}`
            },
            body: JSON.stringify({
              model: "gpt-3.5-turbo",
              messages: [{ role: "user", content: `Write a viral short-form video script for: ${prompt}` }],
              temperature: 0.8
            })
          });

          const data = await response.json();
          const script = data.choices?.[0]?.message?.content || "⚠️ No output received.";
          output.textContent = script;
        } catch (error) {
          output.textContent = "❌ Error generating script. Check your API key and try again.";
          console.error(error);
        }
      });
    } else {
      contentPanel.innerHTML = `<p>Select a module from the sidebar.</p>`;
    }
  }

  // Initialize default view
  displayModule(currentModule);
</script>
